---
title: "texas-tenure"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r data}
tenure_2001 <- read.csv("texas-tenure-2001.csv")
tenure_2015 <- read.csv("texas-tenure-2015.csv")
tenure_2016 <- read.csv("texas-tenure-2016.csv")
tenure_2017 <- read.csv("texas-tenure-2017.csv")
tenure_2018 <- read.csv("texas-tenure-2018.csv")
tenure_2019 <- read.csv("texas-tenure-2019.csv")

#filter for schools with tenured faculty & undergraduate students
tenure_2001 <- tenure_2001 %>% 
  mutate(year = 2001) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))
tenure_2015 <- tenure_2015 %>% 
  mutate(year = 2015) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))
tenure_2016 <- tenure_2016 %>% 
  mutate(year = 2016) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))
tenure_2017 <- tenure_2017 %>% 
  mutate(year = 2017) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))
tenure_2018 <- tenure_2018 %>% 
  mutate(year = 2018) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))
tenure_2019 <- tenure_2019 %>% 
  mutate(year = 2019) %>% 
  filter(!is.na(tenured_total) & !is.na(student_total))

tenure <- bind_rows(tenure_2001, tenure_2015, tenure_2016, tenure_2017, tenure_2018, tenure_2019)

tenure <- tenure %>% 
  mutate(pct_ind_tenured = ind_tenured / tenured_total * 100,
         pct_asian_tenured = asian_tenured / tenured_total * 100,
         pct_black_tenured = black_tenured / tenured_total * 100,
         pct_his_tenured = his_tenured / tenured_total * 100,
         pct_pi_tenured = pi_tenured / tenured_total * 100,
         pct_white_tenured = white_tenured / tenured_total * 100,
         pct_multi_tenured = multi_tenured / tenured_total * 100,
         pct_unknown_tenured = unknown_tenured / tenured_total * 100,
         pct_ind_student = ind_student / student_total * 100,
         pct_asian_student = asian_student / student_total * 100,
         pct_black_student = black_student / student_total * 100,
         pct_his_student = his_student / student_total * 100,
         pct_pi_student = pi_student / student_total * 100,
         pct_white_student = white_student / student_total * 100,
         pct_multi_student = multi_student / student_total * 100,
         pct_unknown_student = unknown_student / student_total * 100)

dfw <- c("The University of Texas at Arlington", "The University of Texas at Dallas", "University of North Texas", 
         "University of North Texas at Dallas", "Texas A & M University-Commerce", "Texas Woman's University", 
         "Southern Methodist University", "Texas Christian University", "Texas Wesleyan University")
flagship <- c("University of Houston", "The University of Texas at Austin", "Texas A & M University-College Station",
              "Texas State University", "Texas Tech University", "Abilene Christian University", "Baylor University", 
              "Rice University")
# HBCUs: Hustonâ€“Tillotson University, Jarvis Christian College, Paul Quinn College, Prairie View A&M University, Southwestern Christian College, St. Philip's College, Texas College, Texas Southern University, Wiley College
```

```{r}
# difference between Black students & professors
tenure %>% 
  filter(year == 2019) %>% 
  select(name, pct_black_tenured, pct_black_student) %>% 
  mutate(diff = pct_black_student - pct_black_tenured) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)

# difference between Hispanic students & professors
tenure %>% 
  filter(year == 2019) %>% 
  select(name, pct_his_tenured, pct_his_student) %>% 
  mutate(diff = pct_his_student - pct_his_tenured) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)

# difference between white students & professors
tenure %>% 
  filter(year == 2019) %>% 
  select(name, pct_white_tenured, pct_white_student) %>% 
  mutate(diff = pct_white_student - pct_white_tenured) %>% 
  arrange(diff) %>% 
  filter(name %in% dfw | name %in% flagship)

tenure %>% 
  filter(year == 2019, name %in% dfw | name %in% flagship)

tenure %>% 
  filter(name %in% dfw | name %in% flagship) %>% 
  select(name, year, tenured_total) %>% 
  pivot_wider(names_from = year, values_from = tenured_total)
```

* mean difference b/w Black undergraduate students & tenured professors: 7%
* mean difference b/w Hispanic undergraduate students & tenured professors: 28%
* mean difference b/w white undergraduate students & tenured professors: -34%
* UNT Dallas has fifth largest difference statewide: 26% Black undergraduate students, 4% Black tenured professors
* TWU has third largest difference statewide: 26% white undergraduate students, 83% white tenured professors

```{r}
# difference from 2015 to 2019 (raw numbers)
tenure %>% 
  filter(year == 2019 | year == 2015) %>% 
  select(name, year, black_tenured) %>% 
  pivot_wider(names_from = year, values_from = black_tenured) %>% 
  filter(!is.na(`2015`) & !is.na(`2019`)) %>% 
  mutate(diff = `2019` - `2015`) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)

# difference from 2015 to 2019 (percentages)
tenure %>% 
  filter(year == 2019 | year == 2015) %>% 
  select(name, year, pct_black_tenured) %>% 
  pivot_wider(names_from = year, values_from = pct_black_tenured) %>% 
  filter(!is.na(`2015`) & !is.na(`2019`)) %>% 
  mutate(diff = `2019` - `2015`) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)

# difference from 2001 to 2019 (raw numbers)
ten_01_raw <- tenure %>% 
  filter(year == 2001) %>% 
  select(name, black_tenured) %>% 
  filter(name %in% tenure_2019$name) %>% 
  arrange(name)
ten_19_raw <- tenure %>% 
  filter(year == 2019) %>% 
  select(name, black_tenured) %>% 
  filter(name %in% tenure_2001$name) %>% 
  arrange(name)
ten_01_raw %>% 
  rename(`2001` = black_tenured) %>% 
  mutate(`2019` = ten_19_raw$black_tenured) %>% 
  mutate(diff = `2019` - `2001`) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)

# difference from 2001 to 2019 (percentages)
ten_01_pct <- tenure %>% 
  filter(year == 2001) %>% 
  select(name, pct_black_tenured) %>% 
  filter(name %in% tenure_2019$name) %>% 
  arrange(name)
ten_19_pct <- tenure %>% 
  filter(year == 2019) %>% 
  select(name, pct_black_tenured) %>% 
  filter(name %in% tenure_2001$name) %>% 
  arrange(name)
ten_01_pct %>% 
  rename(`2001` = pct_black_tenured) %>% 
  mutate(`2019` = ten_19_pct$pct_black_tenured) %>% 
  mutate(diff = `2019` - `2001`) %>% 
  arrange(desc(diff)) %>% 
  filter(name %in% dfw | name %in% flagship)
```

from 2015 to 2019:
* Abilene, SMU, TWU, U of Houston, UNT Dallas had same numbers
* Texas State & UT lost four professors

from 2001 to 2019: 
* TWU had one Black tenured professor both years